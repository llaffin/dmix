{"ast":null,"code":"import Avatar from\"@material-ui/core/Avatar\";import Button from\"@material-ui/core/Button\";import Container from\"@material-ui/core/Container\";import CssBaseline from\"@material-ui/core/CssBaseline\";import Grid from\"@material-ui/core/Grid\";import{makeStyles}from\"@material-ui/core/styles\";import TextField from\"@material-ui/core/TextField\";import Typography from\"@material-ui/core/Typography\";import InsertPhotoIcon from\"@mui/icons-material/InsertPhoto\";import React,{useEffect,useState}from\"react\";import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import{useFilePicker}from\"use-file-picker\";import list from\"./adminFlyerList\";import imageListLoading from\"./imageListLoading\";import Collapsible from\"react-collapsible\";import moment from\"moment\";import AuthService from\"../services/auth-service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({paper:{marginTop:theme.spacing(7),display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.primary.dark},form:{width:\"100%\",// Fix IE 11 issue.\nmarginTop:theme.spacing(3)},submit:{margin:theme.spacing(3,0,2)},textField:{marginLeft:theme.spacing(1),marginRight:theme.spacing(1),width:\"100%\"},collapsibleConatainers:{backgroundColor:\"gold\",width:\"100%\"},openedCollapsibleConatainers:{backgroundColor:\"grey\",width:\"100%\"}}));function FlyerManagementComp(){const classes=useStyles();const[eventName,setEventName]=React.useState(\"\");const[calendarEventDate,setCalendarEventDate]=React.useState(new Date());const[eventDate,setEventDate]=React.useState(new Date());const[file,setFlyerFile]=React.useState();const authService=AuthService.getInstance();const handleEventNameChange=event=>{console.log(\"TRACK NAME CHANGE\");setEventName(event.target.value);};const handlesetFlyerFileChange=event=>{console.log(event);console.log(\"CHANGING FILE --------------------------\");setFlyerFile(event.target.files[0]);};const[message,setMessage]=React.useState(\"\");const[openFileSelector,{filesContent}]=useFilePicker({multiple:false,accept:[\".jpg\",\".png\",\".gif\"]});const ImageListLoading=imageListLoading(list);const[appState,setAppState]=useState({loading:false,flyers:null});async function apiFunc(toInput){const formData=new FormData();formData.append(\"eventName\",toInput.eventName);console.log(\"EventDate in API CALL \"+toInput.eventDate);formData.append(\"eventDate\",toInput.eventDate);formData.append(\"file\",toInput.file);if(!toInput.eventName){alert(\"Error! Event name cannot be empty. Please try again\");console.log(\"Event name is empty\");}else if(!toInput.file){alert(\"Error! No file selected. Please try again\");console.log(\"No file selected\");}const response=await fetch(\"/api/flyer/createFlyer\",{method:\"POST\",headers:new Headers({Authorization:authService.getSecureToken()}),mode:\"cors\",cache:\"no-cache\",credentials:\"same-origin\",redirect:\"follow\",referrerPolicy:\"no-referrer\",body:formData});let body=await response;console.log(body);setMessage(body.ok?\"Flyer added successfully\":\"Flyer failed\");if(!alert(body.ok?\"Flyer added successfully!\":\"Error! Flyer failed to upload. Please try again\")){window.location.reload();}}const handleSubmit=event=>{event.preventDefault();const toInput={eventName,eventDate,file};apiFunc(toInput);setEventName(\"\");setEventDate(\"\");setFlyerFile();console.log(toInput);console.log(eventDate);};const formatEventDate=pCalendarEventDate=>{console.log(\"Logging event Date \"+pCalendarEventDate);setCalendarEventDate(pCalendarEventDate);const formattedDate=moment(pCalendarEventDate).format(\"YYYY-MM-DD\");console.log(\"Formatted Date \"+formattedDate);console.log(\"The datatype \"+typeof formattedDate);return formattedDate;};useEffect(()=>{setAppState({loading:true});const apiUrl=\"/api/flyer/getAllFlyers\";fetch(apiUrl).then(res=>res.json()).then(flyers=>{setAppState({loading:false,flyers:flyers});});},[setAppState]);return/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:false,children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(\"div\",{className:classes.paper,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.avatar,children:/*#__PURE__*/_jsx(InsertPhotoIcon,{})}),/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",children:\"Add Events/Flyers\"}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",required:true,fullWidth:true,id:\"title\",value:eventName,label:\"Event Name\",name:\"eventName\",autoComplete:\"eventName\",helperText:\"cannot be blank\",onChange:handleEventNameChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(\"div\",{id:\"datePicker\",children:[/*#__PURE__*/_jsx(\"p\",{class:\"manageSiteDate\",children:\"Event date:\"}),/*#__PURE__*/_jsx(DatePicker,{required:true,dateFormat:\"yyyy-MM-dd\",selected:calendarEventDate,onChange:calendarEventDate=>setEventDate(formatEventDate(calendarEventDate)),id:\"datePicker\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(\"div\",{id:\"filePicker\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",onChange:handlesetFlyerFileChange,accept:\"image/png, image/jpeg\"}),/*#__PURE__*/_jsx(\"div\",{children:filesContent.map((file,index)=>console.log(\"Test\")(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"File Selected: \",/*#__PURE__*/_jsx(\"b\",{children:file.name})]}),/*#__PURE__*/_jsx(\"br\",{})]})))})]})})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"info\",preventDefault:true,className:classes.submit// onClick={handleSubmit}\n,children:\"Add Flyer\"})]}),/*#__PURE__*/_jsxs(Typography,{style:{margin:7},variant:\"body1\",children:[\"Status: \",message]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Flyers\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flyer-container\",children:/*#__PURE__*/_jsx(ImageListLoading,{isLoading:appState.loading,flyers:appState.flyers})})})]});}export default FlyerManagementComp;","map":{"version":3,"sources":["C:/Users/Jawad/Desktop/Newbyte-ReactJS/src/Components/flyerManagementComp.jsx"],"names":["Avatar","Button","Container","CssBaseline","Grid","makeStyles","TextField","Typography","InsertPhotoIcon","React","useEffect","useState","DatePicker","useFilePicker","list","imageListLoading","Collapsible","moment","AuthService","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","primary","dark","form","width","submit","textField","marginLeft","marginRight","collapsibleConatainers","openedCollapsibleConatainers","FlyerManagementComp","classes","eventName","setEventName","calendarEventDate","setCalendarEventDate","Date","eventDate","setEventDate","file","setFlyerFile","authService","getInstance","handleEventNameChange","event","console","log","target","value","handlesetFlyerFileChange","files","message","setMessage","openFileSelector","filesContent","multiple","accept","ImageListLoading","appState","setAppState","loading","flyers","apiFunc","toInput","formData","FormData","append","alert","response","fetch","method","headers","Headers","Authorization","getSecureToken","mode","cache","credentials","redirect","referrerPolicy","body","ok","window","location","reload","handleSubmit","preventDefault","formatEventDate","pCalendarEventDate","formattedDate","format","apiUrl","then","res","json","map","index","name"],"mappings":"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","sourcesContent":["import Avatar from \"@material-ui/core/Avatar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport InsertPhotoIcon from \"@mui/icons-material/InsertPhoto\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport { useFilePicker } from \"use-file-picker\";\r\nimport list from \"./adminFlyerList\";\r\nimport imageListLoading from \"./imageListLoading\";\r\nimport Collapsible from \"react-collapsible\";\r\nimport moment from \"moment\";\r\nimport AuthService from \"../services/auth-service\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(7),\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.primary.dark,\r\n  },\r\n  form: {\r\n    width: \"100%\", // Fix IE 11 issue.\r\n    marginTop: theme.spacing(3),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  textField: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    width: \"100%\",\r\n  },\r\n  collapsibleConatainers: {\r\n    backgroundColor: \"gold\",\r\n    width: \"100%\",\r\n  },\r\n  openedCollapsibleConatainers: {\r\n    backgroundColor: \"grey\",\r\n    width: \"100%\",\r\n  },\r\n}));\r\n\r\nfunction FlyerManagementComp() {\r\n  const classes = useStyles();\r\n\r\n  const [eventName, setEventName] = React.useState(\"\");\r\n  const [calendarEventDate, setCalendarEventDate] = React.useState(new Date());\r\n  const [eventDate, setEventDate] = React.useState(new Date());\r\n  const [file, setFlyerFile] = React.useState();\r\n\r\n  const authService = AuthService.getInstance();\r\n\r\n  const handleEventNameChange = (event) => {\r\n    console.log(\"TRACK NAME CHANGE\");\r\n    setEventName(event.target.value);\r\n  };\r\n\r\n  const handlesetFlyerFileChange = (event) => {\r\n    console.log(event);\r\n    console.log(\"CHANGING FILE --------------------------\");\r\n    setFlyerFile(event.target.files[0]);\r\n  };\r\n\r\n  const [message, setMessage] = React.useState(\"\");\r\n\r\n  const [openFileSelector, { filesContent }] = useFilePicker({\r\n    multiple: false,\r\n    accept: [\".jpg\", \".png\", \".gif\"],\r\n  });\r\n\r\n  const ImageListLoading = imageListLoading(list);\r\n  const [appState, setAppState] = useState({\r\n    loading: false,\r\n    flyers: null,\r\n  });\r\n\r\n  async function apiFunc(toInput) {\r\n    const formData = new FormData();\r\n\r\n    formData.append(\"eventName\", toInput.eventName);\r\n    console.log(\"EventDate in API CALL \" + toInput.eventDate);\r\n    formData.append(\"eventDate\", toInput.eventDate);\r\n    formData.append(\"file\", toInput.file);\r\n\r\n    if (!toInput.eventName) {\r\n      alert(\"Error! Event name cannot be empty. Please try again\");\r\n      console.log(\"Event name is empty\");\r\n    } else if (!toInput.file) {\r\n      alert(\"Error! No file selected. Please try again\");\r\n      console.log(\"No file selected\");\r\n    }\r\n\r\n    const response = await fetch(\"/api/flyer/createFlyer\", {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: authService.getSecureToken(),\r\n      }),\r\n      mode: \"cors\",\r\n      cache: \"no-cache\",\r\n      credentials: \"same-origin\",\r\n      redirect: \"follow\",\r\n      referrerPolicy: \"no-referrer\",\r\n      body: formData,\r\n    });\r\n    let body = await response;\r\n    console.log(body);\r\n    setMessage(body.ok ? \"Flyer added successfully\" : \"Flyer failed\");\r\n    if (\r\n      !alert(\r\n        body.ok\r\n          ? \"Flyer added successfully!\"\r\n          : \"Error! Flyer failed to upload. Please try again\"\r\n      )\r\n    ) {\r\n      window.location.reload();\r\n    }\r\n  }\r\n\r\n  const handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const toInput = { eventName, eventDate, file };\r\n\r\n    apiFunc(toInput);\r\n    setEventName(\"\");\r\n    setEventDate(\"\");\r\n    setFlyerFile();\r\n\r\n    console.log(toInput);\r\n    console.log(eventDate);\r\n  };\r\n\r\n  const formatEventDate = (pCalendarEventDate) => {\r\n    console.log(\"Logging event Date \" + pCalendarEventDate);\r\n    setCalendarEventDate(pCalendarEventDate);\r\n    const formattedDate = moment(pCalendarEventDate).format(\"YYYY-MM-DD\");\r\n    console.log(\"Formatted Date \" + formattedDate);\r\n\r\n    console.log(\"The datatype \" + typeof formattedDate);\r\n    return formattedDate;\r\n  };\r\n\r\n  useEffect(() => {\r\n    setAppState({ loading: true });\r\n    const apiUrl = `/api/flyer/getAllFlyers`;\r\n    fetch(apiUrl)\r\n      .then((res) => res.json())\r\n      .then((flyers) => {\r\n        setAppState({ loading: false, flyers: flyers });\r\n      });\r\n  }, [setAppState]);\r\n  return (\r\n    <Container component=\"main\" maxWidth={false}>\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <InsertPhotoIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Add Events/Flyers\r\n        </Typography>\r\n        <form className={classes.form} onSubmit={handleSubmit}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                id=\"title\"\r\n                value={eventName}\r\n                label=\"Event Name\"\r\n                name=\"eventName\"\r\n                autoComplete=\"eventName\"\r\n                helperText=\"cannot be blank\"\r\n                onChange={handleEventNameChange}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <div id=\"datePicker\">\r\n                <p class=\"manageSiteDate\">Event date:</p>\r\n                <DatePicker\r\n                  required\r\n                  dateFormat=\"yyyy-MM-dd\"\r\n                  selected={calendarEventDate}\r\n                  onChange={(calendarEventDate) =>\r\n                    setEventDate(formatEventDate(calendarEventDate))\r\n                  }\r\n                  id=\"datePicker\"\r\n                />\r\n              </div>\r\n            </Grid>\r\n\r\n            <Grid item xs={12}>\r\n              <div id=\"filePicker\">\r\n                <input\r\n                  type=\"file\"\r\n                  name=\"file\"\r\n                  onChange={handlesetFlyerFileChange}\r\n                  accept=\"image/png, image/jpeg\"\r\n                ></input>\r\n                <div>\r\n                  {filesContent.map((file, index) =>\r\n                    console.log(\"Test\")(\r\n                      <div>\r\n                        <p>\r\n                          File Selected: <b>{file.name}</b>\r\n                        </p>\r\n                        {/* <p>{file}</p> */}\r\n                        {/* <div key={index}>{file.content}</div> */}\r\n                        <br />\r\n                      </div>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </Grid>\r\n          </Grid>\r\n\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"info\"\r\n            preventDefault\r\n            className={classes.submit}\r\n            // onClick={handleSubmit}\r\n          >\r\n            Add Flyer\r\n          </Button>\r\n        </form>\r\n        <Typography style={{ margin: 7 }} variant=\"body1\">\r\n          Status: {message}\r\n        </Typography>\r\n      </div>\r\n      <div className=\"Flyers\">\r\n        <div className=\"flyer-container\">\r\n          <ImageListLoading\r\n            isLoading={appState.loading}\r\n            flyers={appState.flyers}\r\n          />\r\n        </div>\r\n      </div>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default FlyerManagementComp;\r\n"]},"metadata":{},"sourceType":"module"}