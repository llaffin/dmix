{"ast":null,"code":"import Avatar from\"@material-ui/core/Avatar\";import Box from\"@material-ui/core/Box\";import Button from\"@material-ui/core/Button\";import Container from\"@material-ui/core/Container\";import CssBaseline from\"@material-ui/core/CssBaseline\";import Grid from\"@material-ui/core/Grid\";import{makeStyles}from\"@material-ui/core/styles\";import TextField from\"@material-ui/core/TextField\";import Typography from\"@material-ui/core/Typography\";import LibraryMusicIcon from\"@mui/icons-material/LibraryMusic\";import React,{useEffect,useState}from\"react\";import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import{useFilePicker}from\"use-file-picker\";import list from\"./adminTrackList\";import trackListLoading from\"./trackListLoading\";import Collapsible from\"react-collapsible\";import moment from\"moment\";import AuthService from\"../services/auth-service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({paper:{marginTop:theme.spacing(7),display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.primary.dark},form:{width:\"100%\",// Fix IE 11 issue.\nmarginTop:theme.spacing(3)},submit:{margin:theme.spacing(3,0,2)},textField:{marginLeft:theme.spacing(1),marginRight:theme.spacing(1),width:\"100%\"},collapsibleConatainers:{backgroundColor:\"gold\",width:\"100%\"},openedCollapsibleConatainers:{backgroundColor:\"grey\",width:\"100%\"}}));function TrackManagementComp(){const classes=useStyles();const[title,setTrackName]=React.useState(\"\");const[artist,setTrackArtist]=React.useState(\"\");const[calendarTrackDate,setCalendarTrackDate]=React.useState(new Date());const[releaseDate,setDate]=useState(new Date());const[file,setTrackFile]=React.useState();const authService=AuthService.getInstance();const handleTrackNameChange=event=>{console.log(\"TRACK NAME CHANGE\");setTrackName(event.target.value);};const handleTrackArtistChange=event=>setTrackArtist(event.target.value);const handleCalendarClose=()=>console.log(\"Date is \".concat(releaseDate,\" -- Calendar closed\"));const handleCalendarOpen=()=>console.log(\"Calendar opened\");const handlesetTrackFileChange=event=>{console.log(event);console.log(\"CHANGING FILE --------------------------\");setTrackFile(event.target.files[0]);};const[message,setMessage]=React.useState(\"\");const[openFileSelector,{filesContent}]=useFilePicker({multiple:false,accept:[\".mp3\",\".wav\"]});const ListLoading=trackListLoading(list);const[appState,setAppState]=useState({loading:false,tracks:null});async function apiFunc(toInput){const formData=new FormData();formData.append(\"title\",toInput.title);formData.append(\"artist\",toInput.artist);formData.append(\"releaseDate\",toInput.releaseDate);formData.append(\"file\",toInput.file);if(!toInput.title){alert(\"Error! Title cannot be empty. Please try again\");console.log(\"Title is empty\");}else if(!toInput.artist){alert(\"Error! Artist cannot be empty. Please try again\");console.log(\"Artist is empty\");}else if(!toInput.file){alert(\"Error! No file selected. Please try again\");console.log(\"No file selected\");}const response=await fetch(\"/api/track/createTrack\",{method:\"POST\",headers:new Headers({Authorization:authService.getSecureToken()}),mode:\"cors\",cache:\"no-cache\",credentials:\"same-origin\",redirect:\"follow\",referrerPolicy:\"no-referrer\",body:formData});let body=await response;console.log(body);setMessage(body.ok?\"Track added successfully\":\"Track failed\");if(!alert(body.ok?\"Track added successfully!\":\"Error! Track failed to upload. Please try again\")){window.location.reload();}}const handleSubmit=event=>{event.preventDefault();const toInput={title,artist,releaseDate,file};apiFunc(toInput);setTrackName(\"\");setTrackArtist(\"\");setDate(\"\");setTrackFile();console.log(toInput);console.log(releaseDate);};const formatTrackDate=pCalendarTrackDate=>{console.log(\"Logging track Date \"+pCalendarTrackDate);setCalendarTrackDate(pCalendarTrackDate);const formattedDate=moment(pCalendarTrackDate).format(\"YYYY-MM-DD\");console.log(\"Formatted Date \"+formattedDate);console.log(\"The datatype \"+typeof formattedDate);return formattedDate;};useEffect(()=>{setAppState({loading:true});const apiUrl=\"/api/track/getAllTracks\";fetch(apiUrl).then(res=>res.json()).then(tracks=>{setAppState({loading:false,tracks:tracks});});},[setAppState]);return/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:false,children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(\"div\",{className:classes.paper,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.avatar,children:/*#__PURE__*/_jsx(LibraryMusicIcon,{})}),/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",children:\"Add Tracks\"}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:event=>handleSubmit(event),children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",required:true,fullWidth:true,id:\"title\",value:title,label:\"Track Name\",name:\"title\",autoComplete:\"title\",helperText:\"cannot be blank\",onChange:handleTrackNameChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",required:true,fullWidth:true,id:\"artist\",value:artist,label:\"Track Artist\",type:\"artist\",name:\"artist\",autoComplete:\"artist\",helperText:\"cannot be blank\",onChange:handleTrackArtistChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(\"div\",{id:\"datePicker\",children:[/*#__PURE__*/_jsx(\"p\",{class:\"manageSiteDate\",children:\"Track date:\"}),/*#__PURE__*/_jsx(DatePicker,{required:true,dateFormat:\"yyyy-MM-dd\",selected:calendarTrackDate,onChange:calendarTrackDate=>setDate(formatTrackDate(calendarTrackDate)),id:\"datePicker\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(\"div\",{id:\"filePicker\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",onChange:handlesetTrackFileChange,accept:\"audio/mpeg\"}),/*#__PURE__*/_jsx(\"div\",{children:filesContent.map((file,index)=>console.log(\"Test\")(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"File Selected: \",/*#__PURE__*/_jsx(\"b\",{children:file.name})]}),/*#__PURE__*/_jsx(\"br\",{})]})))})]})})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"info\",preventDefault:true,className:classes.submit// onClick={handleSubmit}\n,children:\"Add Track\"})]}),/*#__PURE__*/_jsxs(Typography,{style:{margin:7},variant:\"body1\",children:[\"Status: \",message]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Tracks\",children:/*#__PURE__*/_jsx(\"div\",{className:\"track-container\",children:/*#__PURE__*/_jsx(ListLoading,{isLoading:appState.loading,tracks:appState.tracks})})})]});}export default TrackManagementComp;","map":{"version":3,"sources":["C:/Users/Jawad/Desktop/Newbyte-ReactJS/src/Components/trackManagementComp.jsx"],"names":["Avatar","Box","Button","Container","CssBaseline","Grid","makeStyles","TextField","Typography","LibraryMusicIcon","React","useEffect","useState","DatePicker","useFilePicker","list","trackListLoading","Collapsible","moment","AuthService","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","primary","dark","form","width","submit","textField","marginLeft","marginRight","collapsibleConatainers","openedCollapsibleConatainers","TrackManagementComp","classes","title","setTrackName","artist","setTrackArtist","calendarTrackDate","setCalendarTrackDate","Date","releaseDate","setDate","file","setTrackFile","authService","getInstance","handleTrackNameChange","event","console","log","target","value","handleTrackArtistChange","handleCalendarClose","handleCalendarOpen","handlesetTrackFileChange","files","message","setMessage","openFileSelector","filesContent","multiple","accept","ListLoading","appState","setAppState","loading","tracks","apiFunc","toInput","formData","FormData","append","alert","response","fetch","method","headers","Headers","Authorization","getSecureToken","mode","cache","credentials","redirect","referrerPolicy","body","ok","window","location","reload","handleSubmit","preventDefault","formatTrackDate","pCalendarTrackDate","formattedDate","format","apiUrl","then","res","json","map","index","name"],"mappings":"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","sourcesContent":["import Avatar from \"@material-ui/core/Avatar\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport LibraryMusicIcon from \"@mui/icons-material/LibraryMusic\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport { useFilePicker } from \"use-file-picker\";\r\nimport list from \"./adminTrackList\";\r\nimport trackListLoading from \"./trackListLoading\";\r\nimport Collapsible from \"react-collapsible\";\r\nimport moment from \"moment\";\r\nimport AuthService from \"../services/auth-service\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(7),\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.primary.dark,\r\n  },\r\n  form: {\r\n    width: \"100%\", // Fix IE 11 issue.\r\n    marginTop: theme.spacing(3),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  textField: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    width: \"100%\",\r\n  },\r\n  collapsibleConatainers: {\r\n    backgroundColor: \"gold\",\r\n    width: \"100%\",\r\n  },\r\n  openedCollapsibleConatainers: {\r\n    backgroundColor: \"grey\",\r\n    width: \"100%\",\r\n  },\r\n}));\r\n\r\nfunction TrackManagementComp() {\r\n  const classes = useStyles();\r\n\r\n  const [title, setTrackName] = React.useState(\"\");\r\n  const [artist, setTrackArtist] = React.useState(\"\");\r\n  const [calendarTrackDate, setCalendarTrackDate] = React.useState(new Date());\r\n  const [releaseDate, setDate] = useState(new Date());\r\n  const [file, setTrackFile] = React.useState();\r\n\r\n  const authService = AuthService.getInstance();\r\n\r\n  const handleTrackNameChange = (event) => {\r\n    console.log(\"TRACK NAME CHANGE\");\r\n    setTrackName(event.target.value);\r\n  };\r\n  const handleTrackArtistChange = (event) => setTrackArtist(event.target.value);\r\n  const handleCalendarClose = () =>\r\n    console.log(`Date is ${releaseDate} -- Calendar closed`);\r\n  const handleCalendarOpen = () => console.log(\"Calendar opened\");\r\n  const handlesetTrackFileChange = (event) => {\r\n    console.log(event);\r\n    console.log(\"CHANGING FILE --------------------------\");\r\n    setTrackFile(event.target.files[0]);\r\n  };\r\n\r\n  const [message, setMessage] = React.useState(\"\");\r\n\r\n  const [openFileSelector, { filesContent }] = useFilePicker({\r\n    multiple: false,\r\n    accept: [\".mp3\", \".wav\"],\r\n  });\r\n\r\n  const ListLoading = trackListLoading(list);\r\n  const [appState, setAppState] = useState({\r\n    loading: false,\r\n    tracks: null,\r\n  });\r\n\r\n  async function apiFunc(toInput) {\r\n    const formData = new FormData();\r\n\r\n    formData.append(\"title\", toInput.title);\r\n    formData.append(\"artist\", toInput.artist);\r\n    formData.append(\"releaseDate\", toInput.releaseDate);\r\n    formData.append(\"file\", toInput.file);\r\n\r\n    if (!toInput.title) {\r\n      alert(\"Error! Title cannot be empty. Please try again\");\r\n      console.log(\"Title is empty\");\r\n    } else if (!toInput.artist) {\r\n      alert(\"Error! Artist cannot be empty. Please try again\");\r\n      console.log(\"Artist is empty\");\r\n    } else if (!toInput.file) {\r\n      alert(\"Error! No file selected. Please try again\");\r\n      console.log(\"No file selected\");\r\n    }\r\n\r\n    const response = await fetch(\"/api/track/createTrack\", {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: authService.getSecureToken(),\r\n      }),\r\n      mode: \"cors\",\r\n      cache: \"no-cache\",\r\n      credentials: \"same-origin\",\r\n      redirect: \"follow\",\r\n      referrerPolicy: \"no-referrer\",\r\n      body: formData,\r\n    });\r\n    let body = await response;\r\n    console.log(body);\r\n    setMessage(body.ok ? \"Track added successfully\" : \"Track failed\");\r\n    if (\r\n      !alert(\r\n        body.ok\r\n          ? \"Track added successfully!\"\r\n          : \"Error! Track failed to upload. Please try again\"\r\n      )\r\n    ) {\r\n      window.location.reload();\r\n    }\r\n  }\r\n\r\n  const handleSubmit = (event) => {\r\n    event.preventDefault();\r\n\r\n    const toInput = { title, artist, releaseDate, file };\r\n\r\n    apiFunc(toInput);\r\n    setTrackName(\"\");\r\n    setTrackArtist(\"\");\r\n    setDate(\"\");\r\n    setTrackFile();\r\n\r\n    console.log(toInput);\r\n    console.log(releaseDate);\r\n  };\r\n\r\n  const formatTrackDate = (pCalendarTrackDate) => {\r\n    console.log(\"Logging track Date \" + pCalendarTrackDate);\r\n    setCalendarTrackDate(pCalendarTrackDate);\r\n    const formattedDate = moment(pCalendarTrackDate).format(\"YYYY-MM-DD\");\r\n    console.log(\"Formatted Date \" + formattedDate);\r\n\r\n    console.log(\"The datatype \" + typeof formattedDate);\r\n    return formattedDate;\r\n  };\r\n\r\n  useEffect(() => {\r\n    setAppState({ loading: true });\r\n    const apiUrl = `/api/track/getAllTracks`;\r\n    fetch(apiUrl)\r\n      .then((res) => res.json())\r\n      .then((tracks) => {\r\n        setAppState({ loading: false, tracks: tracks });\r\n      });\r\n  }, [setAppState]);\r\n  return (\r\n    <Container component=\"main\" maxWidth={false}>\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LibraryMusicIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Add Tracks\r\n        </Typography>\r\n        <form\r\n          className={classes.form}\r\n          onSubmit={(event) => handleSubmit(event)}\r\n        >\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                id=\"title\"\r\n                value={title}\r\n                label=\"Track Name\"\r\n                name=\"title\"\r\n                autoComplete=\"title\"\r\n                helperText=\"cannot be blank\"\r\n                onChange={handleTrackNameChange}\r\n              />\r\n            </Grid>\r\n\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                id=\"artist\"\r\n                value={artist}\r\n                label=\"Track Artist\"\r\n                type=\"artist\"\r\n                name=\"artist\"\r\n                autoComplete=\"artist\"\r\n                helperText=\"cannot be blank\"\r\n                onChange={handleTrackArtistChange}\r\n              />\r\n            </Grid>\r\n\r\n            <Grid item xs={12}>\r\n              <div id=\"datePicker\">\r\n                <p class=\"manageSiteDate\">Track date:</p>\r\n                <DatePicker\r\n                  required\r\n                  dateFormat=\"yyyy-MM-dd\"\r\n                  selected={calendarTrackDate}\r\n                  onChange={(calendarTrackDate) =>\r\n                    setDate(formatTrackDate(calendarTrackDate))\r\n                  }\r\n                  id=\"datePicker\"\r\n                />\r\n              </div>\r\n            </Grid>\r\n\r\n            <Grid item xs={12}>\r\n              <div id=\"filePicker\">\r\n                <input\r\n                  type=\"file\"\r\n                  name=\"file\"\r\n                  onChange={handlesetTrackFileChange}\r\n                  accept=\"audio/mpeg\"\r\n                ></input>\r\n                <div>\r\n                  {filesContent.map((file, index) =>\r\n                    console.log(\"Test\")(\r\n                      <div>\r\n                        <p>\r\n                          File Selected: <b>{file.name}</b>\r\n                        </p>\r\n                        {/* <p>{file}</p> */}\r\n                        {/* <div key={index}>{file.content}</div> */}\r\n                        <br />\r\n                      </div>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </Grid>\r\n          </Grid>\r\n\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"info\"\r\n            preventDefault\r\n            className={classes.submit}\r\n            // onClick={handleSubmit}\r\n          >\r\n            Add Track\r\n          </Button>\r\n        </form>\r\n        <Typography style={{ margin: 7 }} variant=\"body1\">\r\n          Status: {message}\r\n        </Typography>\r\n      </div>\r\n      <div className=\"Tracks\">\r\n        <div className=\"track-container\">\r\n          <ListLoading isLoading={appState.loading} tracks={appState.tracks} />\r\n        </div>\r\n      </div>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default TrackManagementComp;\r\n"]},"metadata":{},"sourceType":"module"}